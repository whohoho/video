<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Tiny test page</title>
    <script type="module">
    import Module from "./opuswasm/opus.wasm.mod.mjs";
    console.log(Module);  
    const mymod = Module();
    document.m = mymod;
    console.log('mymod: ', mymod);  

const EventTargetPrototype = document.__proto__.__proto__.__proto__.__proto__;
const origAddEventListener = EventTargetPrototype.addEventListener;
EventTargetPrototype.addEventListener = function addEventListenerWrapper(type, listener) {
    if (typeof listener !== 'function') throw new Error('bad listener for ' + type);
    return origAddEventListener.apply(this, arguments);
};
    </script>

    <!-- janus.js needs this -->
    <!-- <script src="adapter.js"></script> -->

    <link rel="stylesheet" type="text/css" href="hushpipe.css">

    <!-- HushPipe crypto library -->
    <script src="crypto.js"></script>

    <!-- HushPipe business logic -->
    <script src="hushpipe.js" type="module"></script>

  </head>
  <body>
    <p>
      <fieldset id="misplaced">
        <legend> things that are misplaced </legend>
      </fieldset>

      <fieldset id="hushpipe_controls">
	<legend>Hushpipe controls</legend>
	<button id="hush_newroom">New room + key</button>
	<button id="hush_getkey">Clear</button>
  <select id="hush_serverselect">

    <option value='wss://hlsorigindev.laglab.org/janus'>Testserver, wss</option>
    <option value='wss://localhost/janus'>local, wss (via nginx)</option>
    <!--    <option value='wss://localhost'>local, np, wss</option> -->
    <!--    <option value='wss://hlsorigindev.laglab.org/janus'>Testserver, https</option> -->
    <option value='ws://localhost:8188'>Localhost, ws (direct to janus)</option>
  </select>
	<div>
	  <label>Room key: </label><span id="hush_room_key_label"></span>
	</div>
  
	<button id="hush_camera_record">Record camera</button>
	<button id="hush_camera_stop">STOP camera</button>
	<button id="hush_camera_pause">PAUSE camera</button>
	<button id="hush_camera_resume">RESUME camera</button>
  
      </fieldset>
      <fieldset id="hushpipe_capture_controls" class="hushpipe_capture_controls">
        <legend> camera / mic controls </legend>
       
        <!-- which camera, camera enabled, etc. -->

      </fieldset>
    </p>


    <fieldset>
      <legend>Sending controls</legend>
      <div id="myface" class="grid"> 
      </div>
    </fieldset>

    <fieldset>
      <legend>Friends</legend>
      <button id="hush_render_friends">update Friends</button>

      <div id="friends" class="grid">
      </div>
    </fieldset>

    <!-- Below: Scripts that should run after <body> has been parsed -->

    <!-- Demo code file: -->
    <script>
      //window.hush_onload();
    </script>

  </body>
</html>
